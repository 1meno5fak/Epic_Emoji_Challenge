<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Epic Emoji Challenges - Ø­Ø³Ø§Ù…</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
<style>
  /* ØªØ¹Ø±ÙŠÙ Ù…ØªØºÙŠØ±Ø§Øª CSS Ù„Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ§Ù„Ù…Ø³Ø§ÙØ§Øª */
  :root {
    --primary-blue: #2a9df4;
    --secondary-blue: #2380d9;
    --background-light: #f0f2f5; /* Ù„ÙˆÙ† Ø®Ù„ÙÙŠØ© Ø®ÙÙŠÙ */
    --card-background: white;
    --text-color-dark: #333;
    --error-red: #f44336;
    --success-green: #4CAF50;
    --neutral-gray: #ddd;
    --neutral-gray-hover: #ccc;
    --border-radius-medium: 8px;
    --border-radius-large: 12px;
    --box-shadow-soft: 0 8px 15px rgba(0,0,0,0.1);
    --box-shadow-hover: 0 12px 20px rgba(0,0,0,0.15);

    /* Ø£Ù„ÙˆØ§Ù† ÙˆØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø®Ø§ØµØ© Ø¨Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© */
    --menu-bg-color: #F8F7F4; /* Ù„ÙˆÙ† Ø®Ù„ÙÙŠØ© Ø£ÙˆÙ-ÙˆØ§ÙŠØª Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© */
    --button-border-color: #000; /* Ù„ÙˆÙ† Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø³ÙˆØ¯Ø§Ø¡ Ø§Ù„Ø³Ù…ÙŠÙƒØ© Ù„Ù„Ø£Ø²Ø±Ø§Ø± */
    --button-inner-bg: #EAE8E4; /* Ù„ÙˆÙ† Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ø§Ù„ÙØ§ØªØ­ Ù„Ù„Ø£Ø²Ø±Ø§Ø± */
    --button-text-color: #555; /* Ù„ÙˆÙ† Ù†Øµ Ø§Ø³Ù… Ø§Ù„Ø·ÙˆØ± */

    /* Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø«ÙŠÙ… */
    --page-bg: var(--background-light);
    --main-card-bg: var(--menu-bg-color);
    --text-primary: var(--text-color-dark);
    --button-normal-bg: var(--primary-blue);
    --button-normal-text: white;
    --button-secondary-bg: var(--neutral-gray);
    --button-secondary-text: var(--text-color-dark);
    --wavy-line-color: #333;
  }

  /* Ø§Ù„Ø«ÙŠÙ… Ø§Ù„Ø¯Ø§ÙƒÙ† */
  body.dark-theme {
    --page-bg: #222;
    --main-card-bg: #333;
    --text-primary: #eee;
    --button-normal-bg: #555;
    --button-normal-text: white;
    --button-secondary-bg: #444;
    --button-secondary-text: #eee;
    --wavy-line-color: #eee;
  }

  body {
    font-family: 'Cairo', sans-serif;
    background: var(--page-bg); /* Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØªØºÙŠØ± Ø§Ù„Ø«ÙŠÙ… */
    margin: 0;
    padding: 0;
    text-align: center;
    direction: rtl;
    color: var(--text-primary); /* Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØªØºÙŠØ± Ø§Ù„Ø«ÙŠÙ… */
    line-height: 1.6;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    transition: background-color 0.5s ease, color 0.5s ease; /* Ø§Ù†ØªÙ‚Ø§Ù„ Ø³Ù„Ø³ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø«ÙŠÙ… */
  }

  /* Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Intro, Menu, Game, Settings) */
  #introScreen, #menu, #game, #settingsScreen {
    max-width: 480px;
    width: 90%;
    margin: 20px auto;
    background: var(--main-card-bg); /* Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØªØºÙŠØ± Ø§Ù„Ø«ÙŠÙ… */
    border-radius: var(--border-radius-large);
    padding: 30px 20px;
    box-shadow: 0 8px 15px rgba(0,0,0,0.1); /* Ø¸Ù„ Ù…ÙˆØ­Ø¯ Ù„Ù„Ø´Ø§Ø´Ø§Øª */
    position: relative;
    overflow: hidden;
    animation: fadeIn 0.5s ease-out;
    transition: background-color 0.5s ease, color 0.5s ease;
  }

  /* ØªÙ†Ø³ÙŠÙ‚ Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© */
  #introScreen h1 {
    font-size: 2.5em;
    color: var(--text-primary);
    margin-bottom: 40px;
    font-weight: 700;
  }
  #introScreen .intro-button {
    margin: 15px auto;
    padding: 15px 30px;
    font-size: 24px;
    cursor: pointer;
    border-radius: 40px; /* Ø´ÙƒÙ„ Ø¨ÙŠØ¶Ø§ÙˆÙŠ */
    border: 2px solid var(--button-border-color); /* Ø­Ø¯ÙˆØ¯ Ø³ÙˆØ¯Ø§Ø¡ */
    background: none; /* Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© */
    color: var(--text-primary);
    transition: all 0.3s ease;
    font-weight: bold;
    width: 80%; /* Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
    max-width: 300px;
  }
  #introScreen .intro-button:hover {
    background: rgba(0,0,0,0.05); /* ØªØ£Ø«ÙŠØ± Ù‡ÙˆÙØ± Ø®ÙÙŠÙ */
    transform: translateY(-3px);
  }

  /* ØªÙ†Ø³ÙŠÙ‚ Ø´Ø§Ø´Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª */
  #settingsScreen h2 {
    font-size: 1.8em;
    color: var(--text-primary);
    margin-bottom: 30px;
    font-weight: 700;
  }
  .settings-section {
    margin-bottom: 30px;
    padding: 15px;
    border: 1px solid var(--neutral-gray);
    border-radius: var(--border-radius-medium);
    background-color: var(--card-background); /* Ø®Ù„ÙÙŠØ© Ø¨ÙŠØ¶Ø§Ø¡ Ø¯Ø§Ø®Ù„ Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª */
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    transition: background-color 0.5s ease;
  }
  .settings-section h3 {
    font-size: 1.3em;
    margin-top: 0;
    margin-bottom: 15px;
    color: var(--text-primary);
  }
  .theme-options button {
    margin: 5px;
    padding: 10px 20px;
    font-size: 1.1em;
    border-radius: var(--border-radius-medium);
    border: 1px solid var(--text-color-dark);
    background: none;
    color: var(--text-primary);
    cursor: pointer;
    transition: background-color 0.3s ease, color 0.3s ease;
  }
  .theme-options button.active {
    background: var(--primary-blue);
    color: white;
    border-color: var(--primary-blue);
  }
  .theme-options button:hover:not(.active) {
    background: rgba(0,0,0,0.05);
  }


  /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ø·ÙˆØ§Ø±) */
  #menu h1 {
    font-size: 1.8em;
    margin-bottom: 40px;
    color: var(--text-primary); /* Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØªØºÙŠØ± Ø§Ù„Ø«ÙŠÙ… */
    position: relative;
    display: inline-block;
  }
  #menu h1::before {
    content: '';
    position: absolute;
    top: -20px;
    left: 50%;
    transform: translateX(-50%);
    width: 150%;
    height: 10px;
    /* Ù„ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø®Ø· Ø§Ù„Ù…ØªØ¹Ø±Ø¬ Ù…Ø¹ Ø§Ù„Ø«ÙŠÙ…ØŒ Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡ Ø¨Ù€ JS */
  }

  #menu .modes-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    justify-content: center;
    align-items: center;
    margin-bottom: 20px;
  }

  .mode-button {
    background: none;
    border: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .mode-button:hover {
    transform: translateY(-5px);
  }

  .mode-button-inner {
    width: 90px;
    height: 90px;
    border: 3px solid var(--button-border-color);
    border-radius: 25%;
    background-color: var(--button-inner-bg); /* Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØªØºÙŠØ± Ø§Ù„Ø«ÙŠÙ… */
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    position: relative;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    transition: background-color 0.5s ease;
  }

  /* Updated CSS for the new icon images */
  .mode-icon {
    width: 45px; /* Adjust as needed */
    height: 45px; /* Adjust as needed */
    object-fit: contain; /* Ensures the image scales within its bounds without cropping */
    margin-bottom: 5px;
  }

  .wavy-lines {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .wavy-line {
    width: 30px;
    height: 2px;
    /* Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡ Ø¨Ù€ JS Ù„ÙŠØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„Ø«ÙŠÙ… */
  }

  .mode-name {
    font-size: 1.1em;
    color: var(--button-text-color); /* Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØªØºÙŠØ± Ø§Ù„Ø«ÙŠÙ… */
    margin-top: 10px;
    font-weight: bold;
    white-space: nowrap;
    transition: color 0.5s ease;
  }

  /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø²Ø± Ø§Ù„Ù…Ù†ÙØ±Ø¯ ÙÙŠ Ø§Ù„Ù…Ù†ØªØµÙ */
  #rewardsModeButtonContainer {
    grid-column: 1 / -1;
    display: flex;
    justify-content: center;
  }
  #rewardsModeButtonContainer .mode-button-inner {
    width: 100px;
    height: 100px;
  }
  /* Specific adjustment for the rewards icon if it needs to be larger */
  #rewardsModeButtonContainer .mode-icon {
    width: 55px; /* Larger size for rewards icon */
    height: 55px;
  }


  /* Ø§Ù„Ù€ CSS Ø§Ù„Ø®Ø§Øµ Ø¨Ø´Ø§Ø´Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© */
  #game h2 {
    color: var(--primary-blue);
    margin-bottom: 25px;
    font-weight: 700;
    font-size: 1.8em;
  }
  button:not(.mode-button):not(.intro-button):not(.theme-options button) {
    margin: 10px;
    padding: 14px 25px;
    font-size: 19px;
    cursor: pointer;
    border-radius: var(--border-radius-medium);
    border: none;
    background: var(--button-normal-bg);
    color: var(--button-normal-text);
    transition: all 0.3s ease;
    font-weight: bold;
    min-width: 150px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.08);
  }
  button:not(.mode-button):not(.intro-button):not(.theme-options button):hover {
    background: var(--secondary-blue);
    transform: translateY(-3px);
    box-shadow: var(--box-shadow-hover);
  }

  /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ */
  #emojiContainer {
    position: relative; /* Ù„ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆØ¶Ø¹ Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ù…Ø·Ù„Ù‚Ø© Ø¯Ø§Ø®Ù„Ù‡ */
    width: 130px;
    height: 130px;
    margin: 25px auto;
    border-radius: 15px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    overflow: hidden;
  }

  #emojiImg, #emojiPlaceholder {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: contain;
    transition: opacity 0.3s ease-out;
  }
  #emojiImg.loading {
      opacity: 0;
  }
  #emojiPlaceholder {
      background-size: cover;
      background-position: center;
      display: none;
  }
  #emojiPlaceholder.show {
      display: block;
  }

  /* Ø·Ø¨Ù‚Ø§Øª Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„ØªÙŠ ØªØºØ·ÙŠ Ø§Ù„Ø´Ø§Ø´Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ */
  .full-screen-overlay {
    position: fixed; /* Ù„ØªØºØ·ÙŠØ© Ø§Ù„Ø´Ø§Ø´Ø© Ø¨Ø£ÙƒÙ…Ù„Ù‡Ø§ Ø¨ØºØ¶ Ø§Ù„Ù†Ø¸Ø± Ø¹Ù† Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø© */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 9999; /* ØªØ£ÙƒØ¯ Ø£Ù†Ù‡Ø§ Ø£Ø¹Ù„Ù‰ Ù…Ù† ÙƒÙ„ Ø´ÙŠØ¡ Ø¢Ø®Ø± */
    display: none; /* Ù…Ø®ÙÙŠØ© Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */
    transition: opacity 0.1s ease-out; /* Ø§Ù†ØªÙ‚Ø§Ù„ Ø³Ø±ÙŠØ¹ Ù„Ø¸Ù‡ÙˆØ±/Ø§Ø®ØªÙØ§Ø¡ Ø§Ù„ØªØ£Ø«ÙŠØ± */
  }

  /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ù…Ø±Ø¨Ø¹Ø§Øª Ø§Ù„Ø³ÙˆØ¯Ø§Ø¡ (Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ Ø¨Ù€ JS) */
  #blackSquaresFullScreenOverlay {
    background-color: transparent; /* Ø§Ø¬Ø¹Ù„ Ø§Ù„Ø®Ù„ÙÙŠØ© Ø´ÙØ§ÙØ©ØŒ Ø§Ù„Ù…Ø±Ø¨Ø¹Ø§Øª Ù‡ÙŠ Ø§Ù„ØªÙŠ Ø³ØªÙƒÙˆÙ† Ù…Ø¹ØªÙ…Ø© */
    overflow: hidden; /* Ù„Ø¥Ø®ÙØ§Ø¡ Ø£ÙŠ Ù…Ø±Ø¨Ø¹Ø§Øª ØªØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ÙˆØ¯ */
  }
  /* Ù†Ù…Ø· Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø§Ù„ÙˆØ§Ø­Ø¯ Ø¯Ø§Ø®Ù„ overlay */
  .black-square {
      position: absolute;
      background-color: black; /* Ù„ÙˆÙ† Ø£Ø³ÙˆØ¯ Ù…Ø¹ØªÙ… */
      border-radius: 5px; /* Ø­ÙˆØ§Ù Ø¯Ø§Ø¦Ø±ÙŠØ© Ø®ÙÙŠÙØ© */
  }

  /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø®Ø·ÙˆØ· Ø§Ù„Ø®Ø¶Ø±Ø§Ø¡ Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© */
  #greenLinesFullScreenOverlay {
    background: repeating-linear-gradient(
      to bottom,
      #0F0 0px, /* Ù„ÙˆÙ† Ø£Ø®Ø¶Ø± ÙØ§Ù‚Ø¹ */
      #0F0 10px,
      transparent 10px,
      transparent 30px
    );
    animation: scrollLinesFullScreen 2s linear infinite; /* Ø­Ø±ÙƒØ© Ø£Ø³Ø±Ø¹ */
    opacity: 1; /* ØºÙŠØ± Ø´ÙØ§ÙØ© */
    display: none; /* ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø®ÙØ§Ø¦Ù‡Ø§ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */
  }
  @keyframes scrollLinesFullScreen {
    from { background-position: 0 0; }
    to { background-position: 0 100%; }
  }

  /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¨ÙƒØ³Ù„Ø© Ø¹Ù„Ù‰ ÙƒØ§Ù…Ù„ Ø§Ù„Ø´Ø§Ø´Ø© (Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… backdrop-filter) */
  #pixelateFullScreenOverlay {
    background: rgba(0,0,0,0.1); /* Ø®Ù„ÙÙŠØ© Ø®ÙÙŠÙØ© Ù„ØªÙ…ÙŠÙŠØ² Ø§Ù„ØªØ£Ø«ÙŠØ± */
    backdrop-filter: pixelate(10px); /* ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨ÙƒØ³Ù„Ø© Ø¹Ù„Ù‰ Ù…Ø§ ØªØ­ØªÙ‡Ø§ */
    -webkit-backdrop-filter: pixelate(10px); /* Ù„Ø¯Ø¹Ù… Ø§Ù„ÙˆÙŠØ¨ ÙƒÙŠØª */
    display: none; /* ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø®ÙØ§Ø¦Ù‡Ø§ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */
  }


  #choices {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 15px;
    margin-top: 25px;
  }
  #choices button {
    background: var(--button-secondary-bg);
    color: var(--button-secondary-text);
    min-width: 120px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  }
  #choices button:hover {
    background: var(--neutral-gray-hover);
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.08);
  }
  #choices button.correct-feedback {
      background: var(--success-green);
      color: white;
      box-shadow: 0 0 10px var(--success-green);
  }
  #choices button.wrong-feedback {
      background: var(--error-red);
      color: white;
      box-shadow: 0 0 10px var(--error-red);
  }

  #timer, #hearts {
    font-size: 20px;
    margin: 15px 0 10px;
    font-weight: bold;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    justify-content: center;
  }
  #hearts {
    color: var(--error-red);
  }
  #hearts img {
    width: 30px;
    height: 30px;
    margin: 0 2px;
    vertical-align: middle;
  }
  #hearts span {
    margin-right: 5px;
    color: var(--text-primary);
  }

  #boxMsg {
    font-weight: bold;
    margin: 20px 0;
    font-size: 1.1em;
    color: var(--primary-blue);
  }
  #result {
    font-size: 22px;
    margin-top: 20px;
    font-weight: bold;
    opacity: 0;
    transform: translateY(10px);
    transition: opacity 0.3s ease-out, transform 0.3s ease-out;
  }
  #result.show {
      opacity: 1;
      transform: translateY(0);
  }
  #result.correct {
      color: var(--success-green);
  }
  #result.wrong {
      color: var(--error-red);
  }
  /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ ÙÙŠ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ´Ø§Ø´Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© */
  #backToIntroBtn, #backBtn {
    background: var(--error-red);
    color: white;
    margin-top: 30px;
    padding: 10px 20px;
    font-size: 17px;
    min-width: unset;
    box-shadow: 0 4px 8px rgba(0,0,0,0.08);
  }
  #backToIntroBtn:hover, #backBtn:hover {
    background: #c0392b;
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.1);
  }


  /* Ø±Ø³ÙˆÙ… Ù…ØªØ­Ø±ÙƒØ© Ø¨Ø³ÙŠØ·Ø© Ù„Ù„ØªÙ„Ø§Ø´ÙŠ */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„ØªØµÙ…ÙŠÙ… Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
  @media (max-width: 600px) {
    #menu .modes-grid {
      grid-template-columns: repeat(2, 1fr);
    }
    #rewardsModeButtonContainer {
        grid-column: 1 / -1;
    }
    #introScreen .intro-button {
      width: 90%;
    }
  }

  @media (max-width: 400px) {
    #menu .modes-grid {
      grid-template-columns: 1fr;
    }
    #rewardsModeButtonContainer {
        grid-column: 1 / -1;
    }
  }
</style>
</head>
<body>

<div id="blackSquaresFullScreenOverlay" class="full-screen-overlay"></div>
<div id="greenLinesFullScreenOverlay" class="full-screen-overlay"></div>
<div id="pixelateFullScreenOverlay" class="full-screen-overlay"></div>

<div id="introScreen">
  <h1>* Epic Emoji Challenges *</h1>
  <button class="intro-button" onclick="showMenu()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
  <button class="intro-button" onclick="showSettingsScreen()">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
</div>

<div id="menu" style="display:none;">
  <h1>Ø§Ø®ØªØ± Ø·ÙˆØ±Ùƒ ÙŠØ§ Ø¨Ø·Ù„ ğŸ®:</h1>
  <div class="modes-grid">
    <button class="mode-button" onclick="startGame('classic')">
      <div class="mode-button-inner">
        <img class="mode-icon" src="./icons/classic.png" alt="Classic Mode Icon" />
        <div class="wavy-lines">
          <div class="wavy-line"></div>
          <div class="wavy-line"></div>
          <div class="wavy-line"></div>
        </div>
      </div>
      <span class="mode-name">Ø·ÙˆØ± ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ</span>
    </button>

    <button class="mode-button" onclick="startGame('speed')">
      <div class="mode-button-inner">
        <img class="mode-icon" src="./icons/speed.png" alt="Speed Mode Icon" />
        <div class="wavy-lines">
          <div class="wavy-line"></div>
          <div class="wavy-line"></div>
          <div class="wavy-line"></div>
        </div>
      </div>
      <span class="mode-name">Ø·ÙˆØ± Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ù‚ØµÙˆÙ‰</span>
    </button>

    <button class="mode-button" onclick="startGame('survival')">
      <div class="mode-button-inner">
        <img class="mode-icon" src="./icons/survival.png" alt="Survival Mode Icon" />
        <div class="wavy-lines">
          <div class="wavy-line"></div>
          <div class="wavy-line"></div>
          <div class="wavy-line"></div>
        </div>
      </div>
      <span class="mode-name">Ø·ÙˆØ± ØªØ­Ø¯ÙŠ Ø§Ù„Ø¨Ù‚Ø§Ø¡</span>
    </button>

    <button class="mode-button" onclick="startGame('tricky')">
      <div class="mode-button-inner">
        <img class="mode-icon" src="./icons/tricky.png" alt="Tricky Mode Icon" />
        <div class="wavy-lines">
          <div class="wavy-line"></div>
          <div class="wavy-line"></div>
          <div class="wavy-line"></div>
        </div>
      </div>
      <span class="mode-name">Ø·ÙˆØ± Ø®Ø¯Ø¹Ø© Ø§Ù„Ø¹ÙŠÙ†</span>
    </button>

    <div id="rewardsModeButtonContainer">
      <button class="mode-button" onclick="startGame('rewards')">
        <div class="mode-button-inner">
          <img class="mode-icon" src="./icons/rewards.png" alt="Rewards Mode Icon" />
          <div class="wavy-lines">
            <div class="wavy-line"></div>
            <div class="wavy-line"></div>
            <div class="wavy-line"></div>
          </div>
        </div>
        <span class="mode-name">Ø·ÙˆØ± Ø§Ù„Ø¬ÙˆØ§Ø¦Ø² ÙˆØ§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©</span>
      </button>
    </div>
  </div>
</div>

<div id="settingsScreen" style="display:none;">
    <h2>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h2>
    <div class="settings-section">
        <h3>Ø³Ù…Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©</h3>
        <div class="theme-options">
            <button id="lightThemeBtn" onclick="applyTheme('light')">ÙØ§ØªØ­</button>
            <button id="darkThemeBtn" onclick="applyTheme('dark')">Ø¯Ø§ÙƒÙ†</button>
        </div>
    </div>
    <button id="backToIntroBtn" onclick="showIntroScreen()">ğŸ”™ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
</div>


<div id="game" style="display:none;">
  <h2 id="gameTitle"></h2>
  <div id="timer"></div>
  <div id="hearts"></div>
  <div id="emojiContainer">
    <div id="emojiPlaceholder"></div>
    <img id="emojiImg" src="" alt="emoji" />
  </div>

  <div id="choices">
    <button onclick="checkAnswer('apple')">Apple</button>
    <button onclick="checkAnswer('google')">Google</button>
    <button onclick="checkAnswer('microsoft')">Microsoft</button>
  </div>
  <div id="boxMsg"></div>
  <div id="result"></div>
  <button id="backBtn" onclick="backToMenu()">ğŸ”™ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
</div>

<script>
const HEART_IMAGE_URL = "https://em-content.zobj.net/source/google/428/red-heart_2764-fe0f.png";
const LOADING_GIF_URL = "https://lh5.googleusercontent.com/proxy/OUqG0HgVNVMNorlPCmI4VgJa-3h7uHLkkMy9vdJ0eRsQlvJBytFUS-HvuW-O9EJd-c9xB7KAqlwby4Fzp59g1705FzBuP-F8dC1ZaBQtmLeCu5i6FfSd6Mmzh8mjOwgrEYZwy5UStg"; // Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· Ù„Ø§ ÙŠØ¹Ù…Ù„ ÙƒÙ€ GIF ØªØ­Ù…ÙŠÙ„

const emojiList = [
  { src: "https://em-content.zobj.net/source/apple/391/red-heart_2764-fe0f.png", answer: "apple" },
  { src: "https://em-content.zobj.net/source/google/387/red-heart_2764-fe0f.png", answer: "google" },
  { src: "https://em-content.zobj.net/source/microsoft/379/red-heart_2764-fe0f.png", answer: "microsoft" },
  { src: "https://em-content.zobj.net/source/apple/391/smiling-face-with-heart-eyes_1f60d.png", answer: "apple" },
  { src: "https://em-content.zobj.net/source/google/387/smiling-face-with-heart-eyes_1f60d.png", answer: "google" },
  { src: "https://em-content.zobj.net/source/microsoft/379/smiling-face-with-heart-eyes_1f60d.png", answer: "microsoft" },
  { src: "https://em-content.zobj.net/source/apple/391/alien_1f47d.png", answer: "apple" },
  { src: "https://em-content.zobj.net/source/google/387/alien_1f47d.png", answer: "google" },
  { src: "https://em-content.zobj.net/source/microsoft/379/alien_1f47d.png", answer: "microsoft" },
  { src: "https://em-content.zobj.net/source/apple/391/pizza_1f355.png", answer: "apple" },
  { src: "https://em-content.zobj.net/source/google/387/pizza_1f355.png", answer: "google" },
  { src: "https://em-content.zobj.net/source/microsoft/379/pizza_1f355.png", answer: "microsoft" },
  { src: "https://em-content.zobj.net/source/apple/391/smiling-face-with-sunglasses_1f60e.png", answer: "apple" },
  { src: "https://em-content.zobj.net/source/google/387/smiling-face-with-sunglasses_1f60e.png", answer: "google" },
  { src: "https://em-content.zobj.net/source/microsoft/379/smiling-face-with-sunglasses_1f60e.png", answer: "microsoft" },
  { src: "https://em-content.zobj.net/source/apple/391/pouting-face_1f621.png", answer: "apple" },
  { src: "https://em-content.zobj.net/source/google/387/pouting-face_1f621.png", answer: "google" },
  { src: "https://em-content.zobj.net/source/microsoft/379/pouting-face_1f621.png", answer: "microsoft" },
  { src: "https://em-content.zobj.net/source/apple/391/troll_1f9cc.png", answer: "apple" },
  { src: "https://em-content.zobj.net/source/google/387/troll_1f9cc.png", answer: "google" },
  { src: "https://em-content.zobj.net/source/microsoft/379/troll_1f9cc.png", answer: "microsoft" }
];

let currentIndex = -1;
let usedIndices = [];
let currentMode = "";
let timerId = null;
let trickyEffectTimer = null; // Ù…Ø¤Ù‚Øª Ø®Ø§Øµ Ø¨ØªØ£Ø«ÙŠØ±Ø§Øª Ø®Ø¯Ø¹Ø© Ø§Ù„Ø¹ÙŠÙ†
let timeLeft = 0;
let hearts = 3;
let score = 0;
let choicesButtons = [];

const introScreen = document.getElementById("introScreen");
const menu = document.getElementById("menu");
const game = document.getElementById("game");
const settingsScreen = document.getElementById("settingsScreen");

const gameTitle = document.getElementById("gameTitle");
const emojiImg = document.getElementById("emojiImg");
const emojiPlaceholder = document.getElementById("emojiPlaceholder");
const resultText = document.getElementById("result");
const timerDiv = document.getElementById("timer");
const heartsDiv = document.getElementById("hearts");
const boxMsg = document.getElementById("boxMsg");
const choicesContainer = document.getElementById("choices");

const lightThemeBtn = document.getElementById("lightThemeBtn");
const darkThemeBtn = document.getElementById("darkThemeBtn");

// Ø¹Ù†Ø§ØµØ± ØªØ£Ø«ÙŠØ±Ø§Øª Ø®Ø¯Ø¹Ø© Ø§Ù„Ø¹ÙŠÙ† Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„ØªÙŠ ØªØºØ·ÙŠ Ø§Ù„Ø´Ø§Ø´Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
const blackSquaresFullScreenOverlay = document.getElementById("blackSquaresFullScreenOverlay");
const greenLinesFullScreenOverlay = document.getElementById("greenLinesFullScreenOverlay"); // Ø£Ø¶Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø±
const pixelateFullScreenOverlay = document.getElementById("pixelateFullScreenOverlay"); // Ø£Ø¶Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø±


// Function to show a screen and hide others
function showScreen(screenToShow) {
  introScreen.style.display = "none";
  menu.style.display = "none";
  game.style.display = "none";
  settingsScreen.style.display = "none";
  screenToShow.style.display = "block";
}

function showIntroScreen() {
  showScreen(introScreen);
  // Clear any active game state or timers when returning to intro
  clearInterval(timerId);
  clearTrickyEffect();
}

function showMenu() {
  showScreen(menu);
  // Update wavy lines color based on current theme when menu is shown
  updateWavyLineColors();
}

function showSettingsScreen() {
  showScreen(settingsScreen);
  // Highlight the active theme button
  const currentTheme = localStorage.getItem('theme') || 'light';
  if (currentTheme === 'light') {
    lightThemeBtn.classList.add('active');
    darkThemeBtn.classList.remove('active');
  } else {
    darkThemeBtn.classList.add('active');
    lightThemeBtn.classList.remove('active');
  }
}

function backToMenu() {
  clearInterval(timerId);
  clearTrickyEffect();
  showMenu();
}

function startGame(mode) {
  currentMode = mode;
  score = 0;
  usedIndices = []; // Reset used emojis for a new game
  hearts = 3; // Reset hearts for survival mode

  // Set game title based on mode
  switch (currentMode) {
    case 'classic':
      gameTitle.textContent = "Ø§Ù„Ø·ÙˆØ± Ø§Ù„ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ";
      timerDiv.style.display = 'none'; // No timer in classic
      heartsDiv.style.display = 'none'; // No hearts in classic
      break;
    case 'speed':
      gameTitle.textContent = "Ø·ÙˆØ± Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ù‚ØµÙˆÙ‰";
      timerDiv.style.display = 'flex';
      heartsDiv.style.display = 'none';
      break;
    case 'survival':
      gameTitle.textContent = "Ø·ÙˆØ± ØªØ­Ø¯ÙŠ Ø§Ù„Ø¨Ù‚Ø§Ø¡";
      timerDiv.style.display = 'none';
      heartsDiv.style.display = 'flex';
      updateHeartsDisplay();
      break;
    case 'tricky':
      gameTitle.textContent = "Ø·ÙˆØ± Ø®Ø¯Ø¹Ø© Ø§Ù„Ø¹ÙŠÙ†";
      timerDiv.style.display = 'none';
      heartsDiv.style.display = 'none';
      break;
    case 'rewards':
      gameTitle.textContent = "Ø·ÙˆØ± Ø§Ù„Ø¬ÙˆØ§Ø¦Ø² ÙˆØ§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©";
      timerDiv.style.display = 'none';
      heartsDiv.style.display = 'none';
      break;
  }

  // Clear previous results/messages
  resultText.classList.remove('show', 'correct', 'wrong');
  boxMsg.textContent = "";

  // Prepare choice buttons
  choicesContainer.innerHTML = ''; // Clear existing buttons
  choicesButtons = ['apple', 'google', 'microsoft'].map(company => {
    const button = document.createElement('button');
    button.onclick = () => checkAnswer(company);
    button.textContent = company.charAt(0).toUpperCase() + company.slice(1); // Capitalize first letter
    choicesContainer.appendChild(button);
    return button; // Store reference to the button
  });

  showScreen(game);
  loadNewEmoji();
}

function loadNewEmoji() {
  clearTrickyEffect(); // Clear any existing tricky effects before loading new emoji

  // Check if all emojis have been used
  if (usedIndices.length === emojiList.length) {
    if (currentMode === 'survival') {
      endGame(`Ø£Ø­Ø³Ù†Øª! Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ ÙÙŠ Ø·ÙˆØ± Ø§Ù„Ø¨Ù‚Ø§Ø¡! Ù†Ù‚Ø§Ø·Ùƒ: ${score}`);
    } else {
      endGame("Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ! ØªÙ‡Ø§Ù†ÙŠÙ†Ø§!");
    }
    return;
  }

  let newIndex;
  do {
    newIndex = Math.floor(Math.random() * emojiList.length);
  } while (usedIndices.includes(newIndex));

  currentIndex = newIndex;
  usedIndices.push(currentIndex);

  const emoji = emojiList[currentIndex];

  emojiImg.classList.add('loading');
  emojiImg.src = ''; // Clear current image
  emojiPlaceholder.style.backgroundImage = `url(${LOADING_GIF_URL})`;
  emojiPlaceholder.classList.add('show');

  // Preload image
  const imgPreload = new Image();
  imgPreload.src = emoji.src;
  imgPreload.onload = () => {
    emojiImg.src = emoji.src;
    emojiImg.classList.remove('loading');
    emojiPlaceholder.classList.remove('show');
    resetChoicesFeedback();

    if (currentMode === 'speed') {
      startTimer(5); // 5 seconds for speed mode
    }

    if (currentMode === 'tricky') {
      applyTrickyEffect(); // Apply a random tricky effect
    }
  };
  imgPreload.onerror = () => {
    console.error("Failed to load emoji image:", emoji.src);
    boxMsg.textContent = "Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©ØŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.";
    // Fallback or skip to next emoji
    setTimeout(loadNewEmoji, 1000);
  };
}


function checkAnswer(selectedAnswer) {
  clearInterval(timerId); // Stop timer immediately on answer
  clearTrickyEffect(); // Clear any active tricky effects

  const correctAnswer = emojiList[currentIndex].answer;
  const isCorrect = (selectedAnswer === correctAnswer);

  // Apply feedback to buttons
  choicesButtons.forEach(button => {
    const company = button.textContent.toLowerCase();
    if (company === correctAnswer) {
      button.classList.add('correct-feedback');
    } else if (company === selectedAnswer && !isCorrect) {
      button.classList.add('wrong-feedback');
    }
    button.disabled = true; // Disable all buttons after an answer
  });

  if (isCorrect) {
    score++;
    boxMsg.textContent = "Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! ğŸ‰";
    resultText.textContent = "ØµØ­ÙŠØ­!";
    resultText.classList.remove('wrong');
    resultText.classList.add('show', 'correct');
  } else {
    boxMsg.textContent = `Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©. Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© ÙƒØ§Ù†Øª ${correctAnswer.toUpperCase()}.`;
    resultText.textContent = "Ø®Ø§Ø·Ø¦!";
    resultText.classList.remove('correct');
    resultText.classList.add('show', 'wrong');

    if (currentMode === 'survival') {
      hearts--;
      updateHeartsDisplay();
      if (hearts <= 0) {
        endGame(`Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù‚Ù„ÙˆØ¨! Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©. Ù†Ù‚Ø§Ø·Ùƒ: ${score}`);
        return; // Stop game if no hearts left
      }
    }
  }

  setTimeout(() => {
    resultText.classList.remove('show'); // Hide feedback after a delay
    boxMsg.textContent = ""; // Clear message
    choicesButtons.forEach(button => button.disabled = false); // Re-enable buttons
    loadNewEmoji();
  }, 1500); // 1.5 seconds delay before next emoji
}

function startTimer(duration) {
  timeLeft = duration;
  timerDiv.textContent = `Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${timeLeft} Ø«ÙˆØ§Ù†ÙŠ`;

  clearInterval(timerId); // Clear any existing timer
  timerId = setInterval(() => {
    timeLeft--;
    timerDiv.textContent = `Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${timeLeft} Ø«ÙˆØ§Ù†ÙŠ`;

    if (timeLeft <= 0) {
      clearInterval(timerId);
      boxMsg.textContent = "Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª!";
      resultText.textContent = "Ø®Ø§Ø·Ø¦!";
      resultText.classList.remove('correct');
      resultText.classList.add('show', 'wrong');

      if (currentMode === 'survival') {
        hearts--;
        updateHeartsDisplay();
        if (hearts <= 0) {
          endGame(`Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù‚Ù„ÙˆØ¨! Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©. Ù†Ù‚Ø§Ø·Ùƒ: ${score}`);
          return;
        }
      }

      setTimeout(() => {
        resultText.classList.remove('show');
        boxMsg.textContent = "";
        choicesButtons.forEach(button => button.disabled = false);
        loadNewEmoji();
      }, 1500);
    }
  }, 1000);
}

function updateHeartsDisplay() {
  heartsDiv.innerHTML = `<span>Ø§Ù„Ù‚Ù„ÙˆØ¨: </span>`;
  for (let i = 0; i < hearts; i++) {
    const heartImg = document.createElement('img');
    heartImg.src = HEART_IMAGE_URL;
    heartImg.alt = "Heart";
    heartsDiv.appendChild(heartImg);
  }
}

function resetChoicesFeedback() {
  choicesButtons.forEach(button => {
    button.classList.remove('correct-feedback', 'wrong-feedback');
    button.disabled = false;
  });
}

function endGame(message) {
  clearInterval(timerId);
  clearTrickyEffect();
  boxMsg.textContent = message;
  // Optionally hide game elements and show a "Play Again" button or return to menu
  setTimeout(() => {
    showMenu(); // Return to menu after a short delay
  }, 3000);
}

// Tricky Mode Effects
function applyTrickyEffect() {
  const effects = [
    'none', // No effect
    'black_squares',
    'green_lines',
    'pixelate'
  ];
  const randomEffect = effects[Math.floor(Math.random() * effects.length)];

  clearTrickyEffect(); // Clear previous effects

  switch (randomEffect) {
    case 'black_squares':
      boxMsg.textContent = "Ø®Ø¯Ø¹Ø© Ø§Ù„Ø¹ÙŠÙ†: Ù…Ø±Ø¨Ø¹Ø§Øª Ø³ÙˆØ¯Ø§Ø¡!";
      blackSquaresFullScreenOverlay.style.display = 'block';
      createBlackSquares();
      trickyEffectTimer = setTimeout(clearTrickyEffect, 3000); // Effect lasts 3 seconds
      break;
    case 'green_lines':
      boxMsg.textContent = "Ø®Ø¯Ø¹Ø© Ø§Ù„Ø¹ÙŠÙ†: Ø®Ø·ÙˆØ· Ù…ØªØ­Ø±ÙƒØ©!";
      greenLinesFullScreenOverlay.style.display = 'block';
      trickyEffectTimer = setTimeout(clearTrickyEffect, 3000);
      break;
    case 'pixelate':
      boxMsg.textContent = "Ø®Ø¯Ø¹Ø© Ø§Ù„Ø¹ÙŠÙ†: Ø¨ÙƒØ³Ù„Ø© Ø§Ù„Ø´Ø§Ø´Ø©!";
      pixelateFullScreenOverlay.style.display = 'block';
      trickyEffectTimer = setTimeout(clearTrickyEffect, 3000);
      break;
    case 'none':
    default:
      boxMsg.textContent = "Ø®Ø¯Ø¹Ø© Ø§Ù„Ø¹ÙŠÙ†: Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ£Ø«ÙŠØ± Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø±Ø©.";
      break;
  }
}

function clearTrickyEffect() {
  clearTimeout(trickyEffectTimer);
  blackSquaresFullScreenOverlay.style.display = 'none';
  blackSquaresFullScreenOverlay.innerHTML = ''; // Clear squares
  greenLinesFullScreenOverlay.style.display = 'none';
  pixelateFullScreenOverlay.style.display = 'none';
  if (currentMode === 'tricky') {
     boxMsg.textContent = ""; // Clear tricky message
  }
}

function createBlackSquares() {
  const overlay = blackSquaresFullScreenOverlay;
  const numSquares = 50; // Number of squares
  for (let i = 0; i < numSquares; i++) {
    const square = document.createElement('div');
    square.classList.add('black-square');
    const size = Math.random() * 80 + 20; // Size between 20px and 100px
    const x = Math.random() * (window.innerWidth - size);
    const y = Math.random() * (window.innerHeight - size);
    const opacity = Math.random() * 0.7 + 0.3; // Opacity between 0.3 and 1.0

    square.style.width = `${size}px`;
    square.style.height = `${size}px`;
    square.style.left = `${x}px`;
    square.style.top = `${y}px`;
    square.style.opacity = opacity;
    square.style.transition = 'opacity 0.5s ease-out, transform 0.5s ease-out';
    overlay.appendChild(square);

    // Animate squares slightly
    setTimeout(() => {
        square.style.transform = `scale(${Math.random() * 0.5 + 0.7})`; // Scale between 0.7 and 1.2
    }, 100);
  }
}

// Theme functionality
function applyTheme(theme) {
  document.body.classList.remove('light-theme', 'dark-theme');
  document.body.classList.add(`${theme}-theme`);
  localStorage.setItem('theme', theme);
  updateThemeButtons(theme);
  updateWavyLineColors(); // Update wavy lines when theme changes
}

function updateThemeButtons(activeTheme) {
  lightThemeBtn.classList.remove('active');
  darkThemeBtn.classList.remove('active');
  if (activeTheme === 'light') {
    lightThemeBtn.classList.add('active');
  } else {
    darkThemeBtn.classList.add('active');
  }
}

function updateWavyLineColors() {
    const wavyLines = document.querySelectorAll('.wavy-line');
    const rootStyles = getComputedStyle(document.documentElement);
    const textColor = rootStyles.getPropertyValue('--wavy-line-color').trim(); // Get color from CSS variable

    wavyLines.forEach(line => {
        line.style.backgroundColor = textColor;
    });

    // Update the wavy line under the menu title
    const menuTitle = document.querySelector('#menu h1');
    if (menuTitle) {
        // Remove existing pseudo-element style if any
        menuTitle.style.setProperty('--pseudo-before-background', 'none');

        // Dynamically add a style for the pseudo-element's background
        const styleTag = document.getElementById('menuTitleWavyStyle') || document.createElement('style');
        styleTag.id = 'menuTitleWavyStyle';
        // Use a repeating linear gradient to create the wavy effect
        styleTag.textContent = `
            #menu h1::before {
                background: repeating-linear-gradient(
                    135deg,
                    ${textColor} 0,
                    ${textColor} 5px,
                    transparent 5px,
                    transparent 10px
                );
                background-size: 20px 10px;
                animation: wavyLineAnimation 1s linear infinite;
            }
            @keyframes wavyLineAnimation {
                from { background-position: 0 0; }
                to { background-position: 20px 0; }
            }
        `;
        document.head.appendChild(styleTag);
    }
}


// Initialize theme on page load
document.addEventListener('DOMContentLoaded', () => {
  const savedTheme = localStorage.getItem('theme') || 'light';
  applyTheme(savedTheme);
  showIntroScreen(); // Show intro screen initially
});

</script>

</body>
</html>
